- name: Apply fixes to code
        run: |
          cat > fix_code.py << 'ENDOFPYTHON'
          # Read the current calculator.py
          with open('calculator.py', 'r') as f:
              content = f.read()
          
          original_content = content
          
          # Fix divide method - use exact string replacement
          divide_old = """    def divide(self, a, b):
        \"\"\"
        Divide a by b
        BUG: This will crash if b is 0
        \"\"\"
        # TODO: Add zero division handling
        return a / b"""
          
          divide_new = """    def divide(self, a, b):
        \"\"\"
        Divide a by b
        Raises ValueError if b is zero
        \"\"\"
        if b == 0:
            raise ValueError("Cannot divide by zero")
        return a / b"""
          
          if divide_old in content:
              content = content.replace(divide_old, divide_new)
              print("✅ Fixed divide method")
          else:
              print("ℹ️  Divide method already fixed or pattern not found")
          
          # Fix sqrt method - use exact string replacement
          sqrt_old = """    def sqrt(self, number):
        \"\"\"
        Calculate square root of a number
        BUG: This will crash for negative numbers
        \"\"\"
        # TODO: Add negative number handling
        return math.sqrt(number)"""
          
          sqrt_new = """    def sqrt(self, number):
        \"\"\"
        Calculate square root of a number
        Raises ValueError if number is negative
        \"\"\"
        if number < 0:
            raise ValueError("Cannot calculate square root of negative number")
        return math.sqrt(number)"""
          
          if sqrt_old in content:
              content = content.replace(sqrt_old, sqrt_new)
              print("✅ Fixed sqrt method")
          else:
              print("ℹ️  Sqrt method already fixed or pattern not found")
          
          # Write back
          with open('calculator.py', 'w') as f:
              f.write(content)
          
          if content != original_content:
              print("✅ Applied fixes to calculator.py")
          else:
              print("ℹ️  No changes needed to calculator.py")
          ENDOFPYTHON
          
          python3 fix_code.py
